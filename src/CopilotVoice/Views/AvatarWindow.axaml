<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="using:CopilotVoice.Views"
        x:Class="CopilotVoice.Views.AvatarWindow"
        Title="Copilot Voice"
        Width="280" SizeToContent="Height"
        CanResize="False"
        SystemDecorations="None"
        WindowStartupLocation="Manual"
        Background="Transparent"
        TransparencyLevelHint="Transparent"
        Topmost="True"
        ShowInTaskbar="False">

    <Border Background="#1E1E2E" CornerRadius="12" BorderBrush="#3B3B5C" BorderThickness="1"
            ClipToBounds="True">
        <Grid RowDefinitions="Auto,Auto,*,Auto,Auto,Auto">

            <!-- Header (replaces title bar) -->
            <Border Grid.Row="0" Padding="12,8" Background="#2D2D44"
                    CornerRadius="12,12,0,0">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="ðŸ¤–" FontSize="16" VerticalAlignment="Center"/>
                    <TextBlock Text="Copilot Voice" FontSize="13" FontWeight="Bold"
                               Foreground="#CDD6F4" VerticalAlignment="Center"/>
                    <TextBlock x:Name="StatusBadge" Text="â— Starting..." FontSize="11"
                               Foreground="#F9E2AF" VerticalAlignment="Center" Margin="8,0,0,0"/>
                </StackPanel>
            </Border>

            <!-- Speech Balloon (above avatar) â€” Copilot's voice only -->
            <StackPanel Grid.Row="1" x:Name="BalloonPanel" Margin="14,8,14,0"
                        IsVisible="False">
                <Border Background="#45475A" CornerRadius="10" Padding="12,8">
                    <TextBlock x:Name="SpeechBubble" Text=""
                               FontSize="12" Foreground="#CDD6F4" TextWrapping="Wrap"
                               MaxHeight="60" TextAlignment="Center"/>
                </Border>
                <!-- Triangle pointer pointing down to avatar -->
                <Canvas Height="10" HorizontalAlignment="Center" Width="20">
                    <Polygon Points="0,0 20,0 10,10" Fill="#45475A"/>
                </Canvas>
            </StackPanel>

            <!-- Pixel Art Avatar -->
            <Border Grid.Row="2" Padding="8" HorizontalAlignment="Center" VerticalAlignment="Center">
                <views:PixelAvatarControl x:Name="AvatarPixel"/>
            </Border>

            <!-- Transcription (user's voice) -->
            <Border Grid.Row="3" x:Name="TranscriptionPanel" Padding="8,4" Margin="10,0"
                    IsVisible="False">
                <TextBlock x:Name="TranscriptionText" Text=""
                           FontSize="10" Foreground="#A6ADC8" TextWrapping="Wrap"
                           MaxHeight="32" HorizontalAlignment="Center" FontStyle="Italic"/>
            </Border>

            <!-- Session info -->
            <Border Grid.Row="4" Padding="10,4" Margin="10,0">
                <TextBlock x:Name="SessionLabel" Text="ðŸ“‚ waiting..."
                           FontSize="10" Foreground="#6C7086" HorizontalAlignment="Center"/>
            </Border>

            <!-- Status Bar -->
            <Border Grid.Row="5" Padding="10,6" Background="#2D2D44"
                    CornerRadius="0,0,12,12">
                <Grid ColumnDefinitions="*,Auto">
                    <TextBlock x:Name="HotkeyLabel" Text="âŒ¨ï¸ Ctrl+Space"
                               FontSize="10" Foreground="#6C7086" VerticalAlignment="Center"/>
                    <TextBlock x:Name="TimerLabel" Grid.Column="1" Text=""
                               FontSize="10" Foreground="#F9E2AF" VerticalAlignment="Center"/>
                </Grid>
            </Border>

        </Grid>
    </Border>
</Window>
